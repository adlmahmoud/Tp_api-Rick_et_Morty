package routers

import (
	"net/http"
)

// MainRouter initialise et configure le routeur principal de l'application.
// Il regroupe les différentes sous-routes (erreurs, personnages, fichiers statiques, etc.).
func MainRouter() *http.ServeMux {

	// Création du routeur principal basé sur http.ServeMux
	mainRouter := http.NewServeMux()

	// Enregistrement des routes liées à la gestion des erreurs
	errorRouter(mainRouter)

	// Enregistrement des routes liées aux personnages (/, /rick, etc.)
	charactersRouter(mainRouter)

	// Mise en place d'un serveur de fichiers statiques (CSS, JS, images...)
	// On indique ici le dossier local qui contient les assets.
	fileServer := http.FileServer(http.Dir("./../../assets"))
	// On souhaite servir les fichiers accessibles via l’URL "/static/..."
	// StripPrefix permet de retirer "/static/" de l’URL avant de chercher le fichier dans le dossier.
	mainRouter.Handle("/static/", http.StripPrefix("/static/", fileServer))

	// On retourne le routeur configuré pour qu'il soit utilisé par http.ListenAndServe
	return mainRouter
}